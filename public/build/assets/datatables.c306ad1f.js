class o{sort(t){this.ths=$(t),this.lastIdxThSort=null,this.th=null,this.indexTh=null,this.initSort()}setSettingsTh(t){this.th=t,this.indexTh=this.th.attr("data-kuberId")}initSort(){this.addEventClickSort(),this.setSettingsTh($(this.ths).first()),this.controllerSort()}addEventClickSort(){this.ths.on("click",this.clickControllerSort.bind(this))}clickControllerSort(t){this.setSettingsTh($(t.target)),this.controllerSort()}controllerSortInit(){return this.clearClassItens(),this.indexTh==this.lastIdxThSort?this.sortDesc():this.sortAsc()}controllerSort(){const t=this.controllerSortInit();this.updateSort(t)}sortAsc(){return this.lastIdxThSort=this.indexTh,this.th.addClass("kuber-table-sort-asc"),this.date.registers.sort((t,e)=>{let i=$($(t.element).find("td")[this.indexTh]).text(),a=$($(e.element).find("td")[this.indexTh]).text();return Number(i)&&Number(a)?Number(i)<Number(a)?-1:0:i.localeCompare(a)})}sortDesc(){return this.lastIdxThSort=null,this.th.addClass("kuber-table-sort-desc"),this.date.registers.sort((t,e)=>{let i=$($(t.element).find("td")[this.indexTh]).text(),a=$($(e.element).find("td")[this.indexTh]).text();return Number(i)&&Number(a)?Number(i)<Number(a)?0:-1:a.localeCompare(i)})}clearClassItens(){this.ths.removeClass("kuber-table-sort-asc kuber-table-sort-desc")}}class h extends o{search(t){this.input=$(t),this.initSearch()}initSearch(){this.addEventChangeSearch()}addEventChangeSearch(){$(this.input).on("keyup",this.updateSearchInput.bind(this))}updateSearchInput(){this.text=this.input.val().toUpperCase(),this.createDateTableSearch()}}class d extends h{constructor(){super()}pagination(t,e,i=1){this.seletorRegistrosPorPagina=t,this.containerPagination=$(e),this.qtdRegistrosPorPaginas=10,this.qtdPaginas=null,this.linkPagination=null,this.paginationAtivaAoIniciar=i,this.IniciandoCriacaoDaPaginacao()}setLinkPagination(t){this.linkPagination=t}setQtdPaginas(){this.qtdPaginas=Math.ceil(this.date.registers.length/this.qtdRegistrosPorPaginas)}setQtdRegistrosPorPaginas(){this.qtdRegistrosPorPaginas=Number($(this.seletorRegistrosPorPagina).val())}updatePagination(t=null){let e=t==null?1:t;this.setQtdPaginas(),this.setQtdRegistrosPorPaginas(),e>this.qtdPaginas?e=this.qtdPaginas:e<1&&(e=1),this.setLinkPagination(e),this.createPagination()}IniciandoCriacaoDaPaginacao(){this.addEventChangeRegistrosPorPagina(),this.setQtdRegistrosPorPaginas()}deleteRegistro(t,e){if(t=="success-delete-user"){$(this.body).find(`.kuber-table-tr[data-kuberIdItem=${e}]`).remove(),this.dateAll=this.dateAll.filter(a=>a.id!=e);let i=this.date.registers.filter(a=>a.id!=e);this.updateDateViewer(i)}}addEventChangeRegistrosPorPagina(){Livewire.hook("message.processed",(t,e)=>{let i=null,a=t.response.effects,n=t.updateQueue[0].payload,r=a.returns?Object.values(a.returns)[0]:!1;if(n.event=="delete"){let l=n.params[0];i=this.linkPagination,this.deleteRegistro(r,l)}this.updatePagination(i)})}createPagination(){this.createViewerPagination(),this.alterarPaginationAtiva()}createAppendItemPagination(t=null,e=null,i=""){let a="",n="...";t!=null&&(a=`href="#" data-link="${t}"`,n=e==null?t:e),this.containerPagination.append(`
            <li class="page-item ${i}">
                <a class="page-link" ${a}>${n}</a>
            </li>
        `)}createLoopAppendItemPagination(t,e){for(let i=t;i<=e;i++)this.createAppendItemPagination(i)}createViewerPagination(){this.setQtdPaginas(),this.containerPagination.html(""),this.createAppendItemPagination("prev","Anterior","kuber-link-prev"),this.qtdPaginas>7?this.paginationResponsive():this.paginationDefault(),this.createAppendItemPagination("next","Pr\xF3ximo","kuber-link-next"),this.addEventClickItemPagination()}paginationResponsive(){let t=3,e=this.qtdPaginas-t;this.createAppendItemPagination("1","1"),this.linkPagination>t?this.linkPagination<e&&(this.createAppendItemPagination(),this.createLoopAppendItemPagination(this.linkPagination-1,this.linkPagination+1)):this.createLoopAppendItemPagination(2,5),this.linkPagination>=e?(this.createAppendItemPagination(),this.createLoopAppendItemPagination(this.qtdPaginas-4,this.qtdPaginas-1)):this.createAppendItemPagination(),this.createAppendItemPagination(this.qtdPaginas)}paginationDefault(){this.createLoopAppendItemPagination(1,this.qtdPaginas)}addEventClickItemPagination(){$(this.containerPagination.find(".page-link")).on("click",this.changeClickItemPagination.bind(this))}changeClickItemPagination(t){const e=$(t.target);if(e.closest(".page-item").hasClass("active"))return!1;this.setLinkPagination(e.attr("data-link")),this.alterarPaginationAtiva(),this.createPagination()}alterarPaginationAtiva(){this.setandoLinkPaginationInterativo(),this.changeViewerDateFromPagination()}changeViewerDateFromPagination(){this.updateViewerDateTable()}setandoLinkPaginationInterativo(){this.linkPagination==null&&this.setLinkPagination(this.paginationAtivaAoIniciar);let t=Number($(this.containerPagination.find(".page-item.active .page-link")).attr("data-link"));this.linkPagination=this.linkPagination=="next"?++t:this.linkPagination=="prev"?--t:Number(this.linkPagination),this.alterandoClassesItemPagination()}alterandoClassesItemPagination(){let t=$(this.containerPagination.find(".kuber-link-next")),e=$(this.containerPagination.find(".kuber-link-prev"));this.qtdPaginas==1?(t.addClass("disabled"),e.addClass("disabled")):this.linkPagination>=this.qtdPaginas?(this.linkPagination=this.qtdPaginas,t.addClass("disabled"),e.removeClass("disabled")):this.linkPagination<=1?(t.removeClass("disabled"),e.addClass("disabled")):(t.removeClass("disabled"),e.removeClass("disabled"));let i=$(this.containerPagination.find(`.page-item .page-link[data-link=${this.linkPagination}]`));$(this.containerPagination.find(".page-item")).removeClass("active"),i.closest(".page-item").addClass("active")}}class g extends d{constructor(t){super(),this.table=$(t),this.body=null,this.lines=null,this.dateAll=[],this.date=[],this.text=null,this.createDateAll()}getBody(){return this.body=$(this.table.find("tbody")),this.body}getLines(){return this.lines=$($(this.getBody()).find("tr.kuber-table-tr")),this.lines}createDateAll(){this.getLines().each((t,e)=>{this.dateAll.push({viewer:!1,id:Number($(e).attr("data-kuberIdItem")),element:$(e)})}),this.getLines().remove(),this.updateDateViewer(this.dateAll)}updateDateViewer(t=[]){this.date.registers=t}updateViewerDateTable(){let t=0,e=this.qtdRegistrosPorPaginas*(this.linkPagination-1),i=0,a=this.getBody();a.html("");for(const[n,r]of Object.entries(this.date.registers))r&&(i>=e&&t<this.qtdRegistrosPorPaginas?(r.viewer=!0,t++,a.append(r.element)):(r.viewer=!1,r.element.remove())),i++;this.addEventClickDelete()}addEventClickDelete(){this.table.find("tbody tr.kuber-table-tr .kuber-datatables-action-delete").on("click",t=>{let a=$(t.target).closest("tr.kuber-table-tr").attr("data-kuberIdItem");window.livewire.emit("delete",a),t.preventDefault()})}createDateTableSearch(){var t=this.text.toUpperCase(),e=[];for(const[a,n]of Object.entries(this.dateAll)){var i=$(n.element).find("td.kuber-table-td");i.each((r,l)=>{if(l.innerText.toUpperCase().indexOf(t)>-1)return e.push(n),!1})}this.updateDateViewer(e),this.updatePagination()}updateSort(t){this.updateDateViewer(t),this.updatePagination()}create(){this.updatePagination()}}jQuery(()=>{const s=new g(".kuber-table-datatables");s.pagination("#countForPage","#paginationDatatables"),s.search("#search"),s.sort(".kuber-table-th"),s.create()});
